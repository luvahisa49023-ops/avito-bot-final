# --- –ü–†–ê–í–ò–õ–¨–ù–´–ô –ë–õ–û–ö –ò–ú–ü–û–†–¢–û–í ---
import os
import gspread
import google.generativeai as genai
import telegram
import requests
from oauth2client.service_account import ServiceAccountCredentials
from flask import Flask, request, jsonify
# ------------------------------------

# --- CONFIGURATION (–í–µ—Ä—Å–∏—è –¥–ª—è Render) ---
# –ö–ª—é—á–∏ –±—É–¥—É—Ç –±—Ä–∞—Ç—å—Å—è –∏–∑ "—Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞" –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Environment Variables)
GEMINI_API_KEY = os.environ.get("GEMINI_API_KEY")
TELEGRAM_BOT_TOKEN = os.environ.get("TELEGRAM_BOT_TOKEN")
ADMIN_CHAT_ID = os.environ.get("ADMIN_CHAT_ID")
GOOGLE_SHEET_NAME = os.environ.get("GOOGLE_SHEET_NAME")
SALEBOT_API_KEY = os.environ.get("SALEBOT_API_KEY")
SALEBOT_PROJECT_ID = os.environ.get("SALEBOT_PROJECT_ID")
SALEBOT_SECRET_KEY = os.environ.get("SALEBOT_SECRET_KEY")
# ----------------------------------------------------


# --- GEMINI PROMPT - –í–ê–®–ê –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø –ù–ï–ô–†–û–°–ï–¢–ò ---
GEMINI_PROMPT = """
–¢—ã ‚Äî –Ω–µ–π—Ä–æ-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∫–æ—Ç–æ—Ä—ã–π –æ–±—å—è—Å–Ω–∏—Ç –≤–∞–º –≤—Å–µ –ø—Ä–æ –¥–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É –∏ –ø–æ–º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–∫—É–ø–∫—É. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–¥–∞–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏.
–¢–≤–æ–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è: –≤–µ–∂–ª–∏–≤—ã–π, —á–µ—Ç–∫–∏–π –∏ –ø–æ –¥–µ–ª—É.

–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –¢–û–í–ê–†–ï:
- –¢–æ–≤–∞—Ä: –ü–æ–¥–ø–∏—Å–∫–∞ –≥—É–≥–ª –ø—Ä–æ –Ω–∞ 1 –≥–æ–¥ (veo3, gemini, nano banana, –∏ –≤—Å–µ —á—Ç–æ –≤ –Ω–µ–µ –≤—Ö–æ–¥–∏—Ç).
- –í –∫–æ–º–ø–ª–µ–∫—Ç–µ: –ø–æ—á—Ç–∞, –ø–∞—Ä–æ–ª—å, –∫–æ–¥ 2FA.
- –ì–∞—Ä–∞–Ω—Ç–∏—è: 30 –¥–Ω–µ–π
- –¶–µ–Ω–∞: 500 —Ä—É–±–ª–µ–π.

–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –í–•–û–î–£ –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê:
1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ —Å–∞–π—Ç https://labs.google/flow/about.
2. –í–≤–µ–¥–∏ –ø–æ—á—Ç—É –∏ –ø–∞—Ä–æ–ª—å.
3. –°–∞–π—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç –∫–æ–¥ 2FA. –∑–∞–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç 2fa.fb.rip –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç—É–¥–∞ –¥–ª–∏–Ω–Ω—ã–π –∫–æ–¥ –∫–æ—Ç–æ—Ä—ã–π —è –≤–∞–º –≤—ã–¥–∞–º –∏–ª–∏ —É–∂–µ –≤—ã–¥–∞–ª, –≤—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –Ω–∞ —Å–∞–π—Ç –∏ —Å–∞–π—Ç –≤—ã–¥–∞—Å—Ç –≤–∞–º —à–µ—Å—Ç–∏–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç–µ –≤ –æ–∫–Ω–æ –≥–¥–µ –≤—ã –≤–≤–æ–¥–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ

–ß–ê–°–¢–û –ó–ê–î–ê–í–ê–ï–ú–´–ï –í–û–ü–†–û–°–´ (FAQ):
- –í–æ–ø—Ä–æ—Å: –ü–æ–¥–ø–∏—Å–∫–∞ –≤ –Ω–∞–ª–∏—á–∏–∏?
  –û—Ç–≤–µ—Ç: –î–∞, –≤—Å–µ–≥–¥–∞ –≤ –Ω–∞–ª–∏—á–∏–∏.
- –í–æ–ø—Ä–æ—Å: –ö–∞–∫–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—è?
  –û—Ç–≤–µ—Ç: –ì–∞—Ä–∞–Ω—Ç–∏—è 30 –¥–Ω–µ–π
- –í–æ–ø—Ä–æ—Å: —ç—Ç–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ –≥–æ–¥?
  –û—Ç–≤–µ—Ç: –¥–∞
- –í–æ–ø—Ä–æ—Å: —á—Ç–æ –∑–∞ —Ç–æ–∫–µ–Ω—ã? –∏ –¥—Ä—É–≥–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ —Ç–æ–∫–µ–Ω—ã,
  –û—Ç–≤–µ—Ç: –≤–∞–º –¥–∞–µ—Ç—Å—è –ø–æ 1000 —Ç–æ–∫–µ–Ω–æ–≤ –µ–∂–µ–º–µ—Å—è—á–Ω–æ –≤ —Ç–µ—á–µ–Ω–∏–∏ –≥–æ–¥–∞ –Ω–∞ —Å–∞–π—Ç–µ flow, –ø–ª—é—Å –µ—Å—Ç—å –µ—â–µ –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞ –≤—Ö–æ–¥—è—â–∏—Ö –≤ –ø–æ–¥–ø–∏—Å–∫—É, vids –∏ opal
- –í–æ–ø—Ä–æ—Å: –Ω—É–∂–µ–Ω –≤–ø–Ω?
  –û—Ç–≤–µ—Ç: –¥–∞ –Ω—É–∂–µ–Ω, —Å—Ç—Ä–∞–Ω—ã –ï–≤—Ä–æ–ø—ã –∏–ª–∏ –°–®–ê
- –í–æ–ø—Ä–æ—Å: –∫–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–∫—É–ø–∫–∞?, —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ –ø–æ–¥—Ä–æ–±–Ω–µ–µ? –∏ –ø–æ–¥–æ–±–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
  –û—Ç–≤–µ—Ç: –µ—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞: 1. –ª–∏–±–æ —è –¥–µ–ª–∞—é –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –≤–∞—à—É –ø–æ—á—Ç—É –∫–∞–∫ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç: –≤—ã –¥–∞–µ—Ç–µ –º–Ω–µ –ø–æ—á—Ç—É + –ø–∞—Ä–æ–ª—å —è –∑–∞—Ö–æ–∂—É –∏ –¥–µ–ª–∞—é –≤–∞–º –ø–æ–¥–ø–∏—Å–∫—É, –Ω–æ —Å—Ä–∞–∑—É —Ö–æ—á—É —Å–∫–∞–∑–∞—Ç—å —á—Ç–æ –º–æ–∂–µ—Ç –Ω–µ –¥–∞—Ç—å –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∫—É —Ç–∞–∫ –∫–∞–∫ –≤–∞—à–∞ –ø–æ—á—Ç–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä—Ñ, –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –ø–ª–∞—Ç–∏—Ç—å –Ω–µ –Ω—É–∂–Ω–æ, –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –≤–∑—è—Ç—å —É–∂–µ –≥–æ—Ç–æ–≤—É—é. 2. –ª–∏–±–æ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ —É–∂–µ –≥–æ—Ç–æ–≤—É—é –ø–æ—á—Ç—É –≥–¥–µ –µ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∞, –∏ –ø—Ä–æ—Å—Ç–æ –≤–æ–π–¥–µ—Ç–µ –≤ –Ω–µ–µ –¥–ª—è —ç—Ç–æ–≥–æ —è –¥–∞–º –≤–∞–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é: (–í—Å–µ —à–∞–≥–∏, –∫—Ä–æ–º–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è VPN, —è–≤–ª—è—é—Ç—Å—è –∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏. –ü—É–Ω–∫—Ç –ø—Ä–æ VPN ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π). –®–∞–≥ 1: üöÄ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≤—Ö–æ–¥—É. –ü–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ: –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞, –ü–∞—Ä–æ–ª—å, –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ 2FA. –®–∞–≥ 2: üíª –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω—É–∂–µ–Ω –≤–ø–Ω: –µ—Å–ª–∏ —É –≤–∞—Å –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏–ª–∏ —Ä–∞–±–æ—Ç–µ —Å —Å–∞–π—Ç–∞–º–∏ –Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç—Ä–∞–Ω–Ω–æ, —Ç–æ –≤ —ç—Ç–æ–º –≤–∏–Ω–æ–≤–∞—Ç –≤–∞—à –≤–ø–Ω, –Ω—É–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é –∏–ª–∏ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π –≤–ø–Ω. –í—ã–±–æ—Ä –±—Ä–∞—É–∑–µ—Ä–∞: –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π –±—Ä–∞—É–∑–µ—Ä. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π, –Ω–∞–ø—Ä–∏–º–µ—Ä: Google Chrome, Firefox, Microsoft Edge. –í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞ –≤ flow: https://labs.google/fx/tools/flow. –í–≤–µ–¥–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –ø–æ—á—Ç—É –∏ –ø–∞—Ä–æ–ª—å. –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –æ—Ç–∫—Ä—ã—Ç –¥—Ä—É–≥–æ–π –∞–∫–∫–∞—É–Ω—Ç, –≤—ã–π–¥–∏—Ç–µ –∏–∑ –Ω–µ–≥–æ, –≤—ã–±—Ä–∞–≤ ¬´–í—ã–π—Ç–∏ —Å–æ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤¬ª. –®–∞–≥ 3: üîê –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA). –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç: https://2fa.fb.rip. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ. –°–∞–π—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —à–µ—Å—Ç–∏–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ. –í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—Ö–æ–¥–∞ –≤ Google –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ. –®–∞–≥ 4: üõ°Ô∏è –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. ‚ùóÔ∏è –í–∞–∂–Ω–æ: –ß–∞—Å—Ç–∞—è —Å–º–µ–Ω–∞ IP –∏–ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π VPN. –ù–µ –≤—Ö–æ–¥–∏—Ç–µ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ Google –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ù–µ –º–µ–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª—å –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–Ω–µ–π –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞, —á—Ç–æ–±—ã –Ω–µ —Å–ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –∏–∑-–∑–∞ —Å–º–µ–Ω—ã —Ä–µ–≥–∏–æ–Ω–∞. –®–∞–≥ 5: ‚ú® –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞: –ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Veo, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: https://labs.google/fx/tools/flow. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Gemini, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: https://gemini.google.com/app. –ï—Å–ª–∏ –≤—ã –Ω–µ –≤–æ—à–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–∞–∂–º–∏—Ç–µ ¬´–í–æ–π—Ç–∏¬ª –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏–∑ —Å–ø–∏—Å–∫–∞.
- –í–æ–ø—Ä–æ—Å: –ø–æ–¥–ø–∏—Å–∫–∞ –æ–±—â–∞—è?, –æ–¥–Ω–∞ –ø–æ—á—Ç–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª—é–¥–µ–π?, –≥—Ä—É–ø–ø–æ–≤–∞—è?
  –û—Ç–≤–µ—Ç: –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç —Ç–æ–ª—å–∫–æ –≤–∞—à–∞ –ª–∏—á–Ω–∞—è, –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –∏ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–∫—É
- –í–æ–ø—Ä–æ—Å: –∫–∞–∫ –º–Ω–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ 1 –≥–æ–¥?
  –û—Ç–≤–µ—Ç: –ù–∞ –ø–æ—á—Ç–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–∏—Å—å–º–æ –æ—Ç Google play, –≤–æ–∑–º–æ–∂–Ω–æ –æ–Ω–æ –±—É–¥–µ—Ç –Ω–∞ –∏–Ω–¥–∏–π—Å–∫–æ–º, —Ç–∞–º –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–æ 2026, —ç—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ –≤–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –¥–æ —Å–µ–Ω—Ç—è–±—Ä—è 2026 –≥–æ–¥–∞
- –í–æ–ø—Ä–æ—Å: –∫—É–¥–∞ –æ–ø–ª–∞—á–∏–≤–∞—Ç—å?, –∫–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–ø–ª–∞—Ç–∞?, –¥–∞–≤–∞–π—Ç–µ –æ–ø–ª–∞—á—É.
  –û—Ç–≤–µ—Ç: –µ—Å–ª–∏ —Ç—ã —É–∂–µ –≤—ã–¥–∞–ª –¥–∞–Ω–Ω—ã–µ –∏ –∫–ª–∏–µ–Ω—Ç –∏—Ö –ø—Ä–æ–≤–µ—Ä–∏–ª —Ç–æ –¥–∞–µ—à—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ (+79149229291 —Å–±–µ—Ä –ö—Ä–∏—Å—Ç–∏–Ω–∞ –∏ —á–µ–∫ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞)(–µ–≥–æ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–≤–∞ —Ä–∞–∑–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É), –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç—É –µ—â–µ –Ω–µ –±—ã–ª–∏ –≤—ã–¥–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ —Ç–æ –≥–æ–≤–æ—Ä–∏—à—å –µ–º—É, –æ–ø–ª–∞—Ç–∞ –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É. –ù–æ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å–µ–π—á–∞—Å –∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ç–æ–º —Ç–æ —Å–∫–∏–¥—ã–≤–∞–µ—à—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º)
- –í–æ–ø—Ä–æ—Å: –≤–≤–æ–¥–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞?, –∫–∞–∫–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤–≤–æ–¥–∏—Ç—å?
  –û—Ç–≤–µ—Ç: –ù–µ—Ç, –Ω–∏—á–µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.
- –í–æ–ø—Ä–æ—Å: –∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ —Ü–µ–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è? —Ü–µ–Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è? —Ü–µ–Ω–∞?
  –û—Ç–≤–µ—Ç: –¥–∞, 500 —Ä—É–±
- –í–æ–ø—Ä–æ—Å: –Ω–∞–ø–∏—à—É –≤–∞–º –ø–æ–∑–∂–µ, –ø—Ä–∏–¥—É –¥–æ–º–æ–π –Ω–∞–ø–∏—à—É
  –û—Ç–≤–µ—Ç: –¥–∞ —Ö–æ—Ä–æ—à–æ –æ–∂–∏–¥–∞—é

–¢–í–û–Ø –ó–ê–î–ê–ß–ê:
1. –û—Ç–≤–µ—á–∞–π –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
2. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫—É–ø–∏—Ç—å, –Ω–∞–ø–∏—à–∏ –µ–º—É: "–û—Ç–ª–∏—á–Ω–æ! –¥–ª—è –Ω–∞—á–∞–ª–∞ —è –≤—ã–¥–∞–º –≤–∞–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é (–µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–æ–∫—É–ø–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –∏ —Ç—ã –µ—â–µ –Ω–µ –¥–∞–≤–∞–ª –µ–º—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–æ —ç—Ç–æ–≥–æ), –ø–æ—Å–ª–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å—Ä–∞–∑—É –Ω–∞–ø–∏—à–∏: –∫–∞–∫ –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ—Å—å –∏ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã –Ω–∞–ø–∏—à–∏—Ç–µ, –∏ —è –≤—ã–¥–∞–º –≤–∞–º –¥–∞–Ω–Ω—ã–µ, –∏ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç —á—Ç–æ –≥–æ—Ç–æ–≤, –æ–∑–Ω–∞–∫–æ–º–∏–ª—Å—è, –≤—Å–µ –ø–æ–Ω—è–ª –∏ —Ç–¥. —Ç–æ –≤—ã–¥–∞–µ—à—å –µ–º—É –¥–∞–Ω–Ω—ã–µ
3. –ù–µ –≤–µ–¥–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–∞ –æ—Ç–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Ç–µ–º—ã. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ –¥–µ–ª—É, –≤–µ–∂–ª–∏–≤–æ –≤–µ—Ä–Ω–∏ –µ–≥–æ –∫ –ø–æ–∫—É–ø–∫–µ.
4. –µ—Å–ª–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª —Å–¥–µ–ª–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ –∏ —É–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –¥–∞–Ω–Ω—ã–µ (–ø–æ—á—Ç—É –∏ –ø–∞—Ä–æ–ª—å) —Ç–µ–±–µ –Ω—É–∂–Ω–æ —É–≤–µ–¥–æ–º–∏—Ç—å –º–µ–Ω—è –æ–± —ç—Ç–æ–º, –∏ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É —á—Ç–æ –±—ã –æ–Ω –±—ã–ª –≥–æ—Ç–æ–≤ –Ω–∞–∂–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ.
5. –µ—Å–ª–∏ —É –∫–ª–∏–µ–Ω—Ç–∞ –∫–∞–∫–∏–µ —Ç–æ –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–∞–π—Ç–∞–º —Ç–æ –¥–µ–ª–æ —Ç–æ—á–Ω–æ –≤ –≤–ø–Ω, –≤—Å–µ–≥–¥–∞ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —Å–æ–≤–µ—Ç—É–π –ø–æ–º–µ–Ω—è—Ç—å –ª–æ–∫–∞—Ü–∏—é –≤ –≤–ø–Ω, –∏ —Å–∞–º –≤–ø–Ω —Ç–æ–∂–µ.
6. –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–∫–∏–Ω–µ—Ç —Ñ–æ—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å –∫–∞–∫–∞—è –æ—à–∏–±–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ —É –∫–ª–∏–µ–Ω—Ç–∞ –∏ –ø–æ–º–æ—á—å –µ–º—É –µ–µ —Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è –¥–∞–Ω–Ω—ã–µ –∫–æ—Ç–æ—Ä—ã–µ —è —Ç–µ–±–µ –¥–∞–ª.
7. –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª —á–µ–∫ —Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å –µ–º—É –ø–∞–º—è—Ç–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é (–∏–ª–∏ –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –ø—Ä–æ—Å–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è): –° –ø–æ–º–æ—â—å—é gemini –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å, –ø–∏—Å–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–æ—Ç–æ –∏ –≤–∏–¥–µ–æ, –≥–ª—É–±–æ–∫–æ –∏–∑—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∏ –ø—Ä–æ—Å—Ç–æ –æ–±—â–∞—Ç—å—Å—è —Å —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—Ç–∏—Ç –Ω–∞ –ª—é–±–æ–π –≤–∞—à –≤–æ–ø—Ä–æ—Å. –¢–∞–∫–∂–µ –¥–ª—è —Ç–æ—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ –≤ veo 3 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è 1000 –∫—Ä–µ–¥–∏—Ç–æ–≤ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü –≤ —Ç–µ—á–µ–Ω–∏–∏ –≥–æ–¥–∞ –≤–æ flow –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è 50 –≤–∏–¥–µ–æ –≤ –º–µ—Å—è—Ü –ø–æ 8 —Å–µ–∫—É–Ω–¥. –í –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ flow –≤ –ø–æ–¥–ø–∏—Å–∫—É —Ç–∞–∫–∂–µ –≤—Ö–æ–¥—è—Ç —Å–µ—Ä–≤–∏—Å—ã vids –∏ opal (–ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ) –æ—Ç google, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç —Ä–∞—Å—à–∏—Ä–∏—Ç—å —É–∂–µ –∏–º–µ—é—â–∏–π—Å—è –ª–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Å–µ—Ä–≤–∏—Å–µ flow. –í –ø–æ–¥–ø–∏—Å–∫–µ –ø–æ–≤—ã—à–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã –Ω–∞ nano banano –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–∏–ø–µ—Ä —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–¥–æ 1000 –≤ —Å—É—Ç–∫–∏)
8. –Ω–µ –ø–∏—à–∏ —Å–ª–æ–≤–æ –∞–∫–∫–∞—É–Ω—Ç—ã —Ç–∞–∫ —á–∞—Å—Ç–æ, —Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ –º–æ–∂–Ω–æ –º–µ–Ω—å—à–µ, –∏—Å–ø–æ–ª—å–∑—É–π —Å–ª–æ–≤–æ –ø–æ–¥–ø–∏—Å–∫–∞ –∫–æ–≥–¥–∞ —ç—Ç–æ —É–º–µ—Å—Ç–Ω–æ.
"""
# ----------------------------------------------------

# --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò –ù–ê–°–¢–†–û–ô–ö–ê –°–ï–†–í–ò–°–û–í ---
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gemini
genai.configure(api_key=GEMINI_API_KEY)
model = genai.GenerativeModel('gemini-1.0-pro')

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Flask
app = Flask(__name__)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram-–±–æ—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
try:
    telegram_bot = telegram.Bot(token=TELEGRAM_BOT_TOKEN)
except Exception as e:
    print(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram –±–æ—Ç–∞: {e}")
    telegram_bot = None

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Google Sheets
try:
    scope = ['https://spreadsheets.google.com/feeds', 'https://www.googleapis.com/auth/drive']
    creds = ServiceAccountCredentials.from_json_keyfile_name('credentials.json', scope)
    client = gspread.authorize(creds)
    sheet = client.open(GOOGLE_SHEET_NAME).sheet1
except Exception as e:
    print(f"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Google Sheets: {e}")
    sheet = None
# ----------------------------------------------------

# --- –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ë–û–¢–ê ---
def send_telegram_notification(message):
    if telegram_bot and ADMIN_CHAT_ID:
        try:
            telegram_bot.send_message(chat_id=ADMIN_CHAT_ID, text=message)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram: {e}")

def send_message_via_salebot(client_id, text):
    url = f"https://api.salebot.pro/v1/projects/{SALEBOT_PROJECT_ID}/clients/{client_id}/send_message"
    payload = {"api_key": SALEBOT_API_KEY, "message": text}
    try:
        response = requests.post(url, json=payload)
        response.raise_for_status()
    except requests.exceptions.RequestException as e:
        print(f"!!! –û–®–ò–ë–ö–ê –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Salebot: {e}")

@app.route('/webhook', methods=['POST'])
def salebot_webhook():
    data = request.json
    client_id = data.get('client', {}).get('id')
    message_text = data.get('message')

    if not client_id or not message_text:
        return jsonify({'status': 'ok'})

    try:
        # –ú–æ–¥–µ–ª—å Gemini –º–æ–∂–µ—Ç –±—ã—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–º –ø—Ä–æ–º–ø—Ç–∞–º.
        # –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–ª–∏–Ω—É –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞, –Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ—Å—Ç–∞–≤–∏–º —Ç–∞–∫.
        full_prompt = GEMINI_PROMPT + "\n\n–¢–µ–∫—É—â–∏–π –¥–∏–∞–ª–æ–≥:\n–ö–ª–∏–µ–Ω—Ç: " + message_text
        response = model.generate_content(full_prompt)
        gemini_answer = response.text
    except Exception as e:
        print(f"!!! –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê –æ—Ç API Gemini: {e} !!!")
        gemini_answer = "–ò–∑–≤–∏–Ω–∏—Ç–µ, —É –º–µ–Ω—è –≤–æ–∑–Ω–∏–∫–ª–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."

    send_message_via_salebot(client_id, gemini_answer)

    # –õ–æ–≥–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –∑–∞–¥–∞—á–∞—Ö –∏–∑ –ø—Ä–æ–º–ø—Ç–∞
    if "—Ç–µ–±–µ –Ω—É–∂–Ω–æ —É–≤–µ–¥–æ–º–∏—Ç—å –º–µ–Ω—è –æ–± —ç—Ç–æ–º" in gemini_answer: # –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä
        notification_message = f"‚ùóÔ∏è –ö–ª–∏–µ–Ω—Ç (ID: {client_id}) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏."
        send_telegram_notification(notification_message)
    
    if "+79149229291" in gemini_answer:
        notification_message = f"‚ùóÔ∏è –ö–ª–∏–µ–Ω—Ç (ID: {client_id}) –ø–æ–ª—É—á–∏–ª —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã."
        send_telegram_notification(notification_message)

    return jsonify({'status': 'ok'})